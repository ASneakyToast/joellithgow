class u{constructor(){this.currentTheme="default",this.shortcuts=new Map,this.focusTraps=new Map,this.init()}init(){this.setupGlobalKeyboardShortcuts(),this.setupFocusManagement(),this.setupThemeAnnouncements(),this.setupModalFocusTraps(),this.setupAccessibilityFeatures()}setupGlobalKeyboardShortcuts(){this.shortcuts.set("ctrl+t",()=>this.cycleTheme()),this.shortcuts.set("cmd+t",()=>this.cycleTheme()),this.shortcuts.set("escape",()=>this.closeModals()),this.shortcuts.set("ctrl+/",()=>this.showKeyboardHelp()),this.shortcuts.set("cmd+/",()=>this.showKeyboardHelp()),document.addEventListener("keydown",e=>{const t=this.getKeyboardShortcut(e),s=this.shortcuts.get(t);s&&(e.preventDefault(),s()),e.key==="Tab"&&this.handleTabNavigation(e)})}getKeyboardShortcut(e){const t=[];e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("cmd"),e.altKey&&t.push("alt"),e.shiftKey&&t.push("shift");const s=e.key.toLowerCase();return t.length>0?`${t.join("+")}+${s}`:s}cycleTheme(){const e=["default","cyber","ocean","sunset","minimal","neon"],t=document.documentElement.getAttribute("data-theme")||"default",n=(e.indexOf(t)+1)%e.length,a=e[n];document.documentElement.setAttribute("data-theme",a),localStorage.setItem("portfolio-theme",a),this.announceThemeChange(a),window.dispatchEvent(new CustomEvent("themeChange",{detail:a}))}closeModals(){document.querySelectorAll(".theme-modal, .case-study-modal, .game-overlay").forEach(t=>{if(!t.classList.contains("hidden")){t.classList.add("hidden");const s=this.focusTraps.get(t.id);s&&(s.focus(),this.focusTraps.delete(t.id))}}),window.closeThemeModal&&window.closeThemeModal(),window.caseStudyModal&&window.caseStudyModal.close()}showKeyboardHelp(){let e=document.getElementById("keyboard-help-modal");e||(e=this.createKeyboardHelpModal(),document.body.appendChild(e)),e.classList.remove("hidden");const t=e.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');t&&t.focus()}createKeyboardHelpModal(){const e=document.createElement("div");e.id="keyboard-help-modal",e.className="theme-modal hidden",e.setAttribute("role","dialog"),e.setAttribute("aria-labelledby","keyboard-help-title"),e.setAttribute("aria-modal","true"),e.innerHTML=`
        <div class="theme-modal-content">
          <div class="theme-modal-header">
            <h3 id="keyboard-help-title">Keyboard Shortcuts</h3>
            <button class="theme-modal-close" aria-label="Close keyboard shortcuts help">&times;</button>
          </div>
          <div class="keyboard-shortcuts-list">
            <div class="shortcut-item">
              <kbd>Ctrl</kbd> + <kbd>T</kbd> <span>Cycle themes</span>
            </div>
            <div class="shortcut-item">
              <kbd>Escape</kbd> <span>Close modals and overlays</span>
            </div>
            <div class="shortcut-item">
              <kbd>Ctrl</kbd> + <kbd>/</kbd> <span>Show this help</span>
            </div>
            <div class="shortcut-item">
              <kbd>Tab</kbd> <span>Navigate between interactive elements</span>
            </div>
            <div class="shortcut-item">
              <kbd>Enter</kbd> / <kbd>Space</kbd> <span>Activate buttons and links</span>
            </div>
            <div class="shortcut-item">
              <kbd>↑↓←→</kbd> <span>Navigate Snake game</span>
            </div>
          </div>
        </div>
      `;const t=e.querySelector(".theme-modal-close");return t&&t.addEventListener("click",()=>{e.classList.add("hidden")}),e.addEventListener("click",s=>{s.target===e&&e.classList.add("hidden")}),e}setupFocusManagement(){document.addEventListener("focusin",e=>{const t=e.target;t.classList.contains("floating-element")&&(t.style.boxShadow="0 0 0 3px var(--accent-primary)")}),document.addEventListener("focusout",e=>{const t=e.target;t.classList.contains("floating-element")&&(t.style.boxShadow="")})}setupThemeAnnouncements(){const e=document.createElement("div");e.id="theme-announcer",e.className="sr-only",e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),document.body.appendChild(e)}announceThemeChange(e){const t=document.getElementById("theme-announcer");t&&(t.textContent=`Theme changed to ${e}`)}setupModalFocusTraps(){const e=new MutationObserver(s=>{s.forEach(n=>{if(n.type==="attributes"&&n.attributeName==="class"){const a=n.target;(a.classList.contains("theme-modal")||a.classList.contains("case-study-modal"))&&(a.classList.contains("hidden")||this.setupFocusTrap(a))}})});document.querySelectorAll(".theme-modal, .case-study-modal, .game-overlay").forEach(s=>{e.observe(s,{attributes:!0,attributeFilter:["class"]})})}setupFocusTrap(e){const t=document.activeElement;t&&e.id&&this.focusTraps.set(e.id,t);const s=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(s.length>0){s[0].focus();const n=s[0],a=s[s.length-1];e.addEventListener("keydown",o=>{o.key==="Tab"&&(o.shiftKey?document.activeElement===n&&(o.preventDefault(),a.focus()):document.activeElement===a&&(o.preventDefault(),n.focus()))})}}handleTabNavigation(e){const t=document.activeElement;if(t&&(t.style.visibility==="hidden"||t.style.display==="none"||t.hasAttribute("disabled"))){const s=document.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"]):not([disabled])'),n=Array.from(s).indexOf(t),a=e.shiftKey?n-1:n+1;a>=0&&a<s.length&&(e.preventDefault(),s[a].focus())}}setupAccessibilityFeatures(){document.querySelectorAll(".floating-element").forEach(t=>{t.hasAttribute("tabindex")||t.setAttribute("tabindex","0"),t.hasAttribute("aria-label")||t.setAttribute("aria-label",`Draggable element: ${t.textContent||"floating element"}`),t.addEventListener("keydown",s=>{const n=s.shiftKey?50:10;let a=!1;switch(s.key){case"ArrowLeft":s.preventDefault(),this.moveElement(t,-n,0),a=!0;break;case"ArrowRight":s.preventDefault(),this.moveElement(t,n,0),a=!0;break;case"ArrowUp":s.preventDefault(),this.moveElement(t,0,-n),a=!0;break;case"ArrowDown":s.preventDefault(),this.moveElement(t,0,n),a=!0;break}if(a){const o=document.getElementById("theme-announcer");o&&(o.textContent="Element moved")}})})}moveElement(e,t,s){const n=e.getBoundingClientRect(),a=n.left+t,o=n.top+s,i=10,c=window.innerWidth-n.width-i,d=window.innerHeight-n.height-i,l=Math.max(i,Math.min(a,c)),r=Math.max(i,Math.min(o,d));e.style.position="fixed",e.style.left=`${l}px`,e.style.top=`${r}px`,e.style.zIndex="1000"}}const h=new u;window.accessibilityManager=h;
